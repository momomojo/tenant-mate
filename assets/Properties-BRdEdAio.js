import{u as E,j as e}from"./vendor-query-BBSsXiBS.js";import{u as V,a as c}from"./vendor-react-Cua_SOQ2.js";import{c as N,u as q,a as F,I as h,b as m,L as u,C as B,S as H,d as $,e as O,f as Q,B as l,g as R,m as j,U as z,s as d}from"./index-De75nt2H.js";import{S as W,A as K,H as Z}from"./AppSidebar-BMrVA_Jp.js";import{T as G}from"./TopBar-ioa75gCp.js";import{D as J,a as X,b as Y,c as ee,d as se}from"./dialog-CU0zoF6x.js";import{S as te}from"./search-CHJz-TVc.js";import{P as y}from"./plus-CuU8l0SB.js";import"./vendor-ui-Dpa_eFEd.js";import"./vendor-supabase-By2EX_dj.js";import"./useAuthenticatedUser-DxFjEeTf.js";import"./scroll-area-DovF1kS9.js";const re=N("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);const ae=N("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),w={residential:{label:"Residential",icon:Z,color:"text-brand-blue",bgColor:"bg-brand-blue/10"},commercial:{label:"Commercial",icon:re,color:"text-status-success",bgColor:"bg-status-success/10"},mixed_use:{label:"Mixed Use",icon:l,color:"text-brand-purple-light",bgColor:"bg-brand-purple/10"},industrial:{label:"Industrial",icon:ae,color:"text-status-warning",bgColor:"bg-status-warning/10"}},be=()=>{const o=V(),[a,v]=c.useState(""),[S,n]=c.useState(!1),{toast:x}=q();c.useEffect(()=>{(async()=>{const{data:{session:t}}=await d.auth.getSession();t||o("/auth")})()},[o]);const{data:C,isLoading:A,refetch:k}=E({queryKey:["properties"],queryFn:async()=>{const{data:s,error:t}=await d.from("properties").select(`
          *,
          units:units(
            id,
            unit_number,
            status,
            tenant_units(
              tenant:tenant_id(
                first_name,
                last_name
              )
            )
          )
        `);if(t)throw t;return s}}),{register:p,handleSubmit:P,reset:_,control:T,formState:{isSubmitting:g}}=F({defaultValues:{property_type:"residential"}}),M=async s=>{try{const{error:t}=await d.from("properties").insert({name:s.name,address:s.address,property_type:s.property_type,created_by:(await d.auth.getUser()).data.user?.id});if(t)throw t;x({title:"Success",description:"Property added successfully"}),_(),n(!1),k()}catch{x({title:"Error",description:"Failed to add property. Please try again.",variant:"destructive"})}},b=C?.filter(s=>s.name.toLowerCase().includes(a.toLowerCase())||s.address.toLowerCase().includes(a.toLowerCase()));return e.jsx(W,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-background",children:[e.jsx(K,{}),e.jsx("main",{className:"flex-1 p-4 sm:p-8 overflow-x-hidden",children:e.jsxs("div",{className:"flex flex-col gap-6 sm:gap-8",children:[e.jsx(G,{title:"Properties",subtitle:"Manage your properties and units"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(te,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(h,{placeholder:"Search properties...",value:a,onChange:s=>v(s.target.value),className:"pl-10 bg-white/[0.04] border-white/[0.08] text-white placeholder:text-muted-foreground/50 focus:border-brand-indigo/50 rounded-xl h-10"})]}),e.jsxs(J,{open:S,onOpenChange:n,children:[e.jsx(X,{asChild:!0,children:e.jsxs(m,{className:"bg-brand-indigo hover:bg-brand-indigo-light text-white rounded-xl h-10 px-5 shadow-glow-sm hover:shadow-glow transition-all duration-300",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Add Property"]})}),e.jsxs(Y,{className:"bg-surface-elevated border-white/[0.08] rounded-2xl",children:[e.jsx(ee,{children:e.jsx(se,{className:"text-white text-lg",children:"Add New Property"})}),e.jsxs("form",{onSubmit:P(M),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",className:"text-xs font-medium text-muted-foreground",children:"Property Name"}),e.jsx(h,{id:"name",placeholder:"Enter property name",...p("name",{required:!0}),className:"bg-white/[0.04] border-white/[0.08] text-white placeholder:text-muted-foreground/50 focus:border-brand-indigo/50 rounded-xl h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"address",className:"text-xs font-medium text-muted-foreground",children:"Address"}),e.jsx(h,{id:"address",placeholder:"Enter property address",...p("address",{required:!0}),className:"bg-white/[0.04] border-white/[0.08] text-white placeholder:text-muted-foreground/50 focus:border-brand-indigo/50 rounded-xl h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-xs font-medium text-muted-foreground",children:"Property Type"}),e.jsx(B,{name:"property_type",control:T,render:({field:s})=>e.jsxs(H,{value:s.value,onValueChange:s.onChange,children:[e.jsx($,{className:"bg-white/[0.04] border-white/[0.08] text-white rounded-xl h-11",children:e.jsx(O,{placeholder:"Select type"})}),e.jsx(Q,{className:"bg-surface-elevated border-white/[0.08]",children:Object.entries(w).map(([t,r])=>e.jsx(R,{value:t,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r.icon,{className:"h-4 w-4"}),r.label]})},t))})]})})]}),e.jsx(m,{type:"submit",className:"w-full bg-brand-indigo hover:bg-brand-indigo-light text-white rounded-xl h-11 mt-2",disabled:g,children:g?"Adding...":"Add Property"})]})]})]})]}),A?e.jsx("div",{className:"grid gap-5 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsxs("div",{className:"rounded-2xl bg-white/[0.04] border border-white/[0.08] p-5 space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-5 w-32 skeleton"}),e.jsx("div",{className:"h-4 w-48 skeleton"}),e.jsx("div",{className:"h-8 w-full skeleton"})]},s))}):b?.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 rounded-2xl bg-white/[0.04] border border-white/[0.08] mb-4",children:e.jsx(l,{className:"h-7 w-7 text-muted-foreground"})}),e.jsx("h3",{className:"text-base font-medium text-white mb-1",children:"No properties found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a?"Try a different search term":"Add your first property to get started"}),!a&&e.jsxs(m,{onClick:()=>n(!0),className:"bg-brand-indigo hover:bg-brand-indigo-light text-white rounded-xl",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Add Property"]})]}):e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},className:"grid gap-5 md:grid-cols-2 lg:grid-cols-3",children:b?.map((s,t)=>{const r=s.units?.length||0,L=s.units?.filter(D=>D.status==="occupied").length||0,f=r>0?Math.round(L/r*100):0,I=s.property_type||"residential",i=w[I],U=i?.icon||l;return e.jsx(j.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:t*.05},children:e.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-white/[0.04] border border-white/[0.08] p-5 hover:bg-white/[0.06] hover:border-white/[0.12] transition-all duration-300 cursor-pointer card-hover-lift",onClick:()=>o(`/properties/${s.id}`),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-semibold text-white truncate mb-0.5",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.address})]}),e.jsxs("div",{className:`flex items-center gap-1.5 text-[10px] font-medium px-2 py-1 rounded-full ${i?.bgColor||"bg-white/[0.06]"} ${i?.color||"text-muted-foreground"}`,children:[e.jsx(U,{className:"h-3 w-3"}),e.jsx("span",{children:i?.label||"Property"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-lg bg-brand-indigo/10",children:e.jsx(l,{className:"h-3.5 w-3.5 text-brand-indigo-light"})}),e.jsxs("span",{className:"text-sm text-gray-300",children:[r," Units"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-lg bg-brand-purple/10",children:e.jsx(z,{className:"h-3.5 w-3.5 text-brand-purple-light"})}),e.jsxs("span",{className:"text-sm text-gray-300",children:[f,"% Occupied"]})]})]}),e.jsx("div",{className:"w-full h-1.5 bg-white/[0.06] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-brand-indigo to-brand-purple rounded-full transition-all duration-500",style:{width:`${f}%`}})})]})},s.id)})})]})})]})})};export{be as default};
