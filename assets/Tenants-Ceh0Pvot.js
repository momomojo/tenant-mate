import{u as h,j as e}from"./vendor-query-BBSsXiBS.js";import{u,a as j}from"./vendor-react-Cua_SOQ2.js";import{b as p,s as n}from"./index-De75nt2H.js";import{S as l,A as c}from"./AppSidebar-BMrVA_Jp.js";import{T as f,a as b,b as d,c as t,d as N,e as i}from"./table-D-R88hVk.js";import{A as v,a as g}from"./avatar-BzXIJ7c5.js";import{M as y}from"./mail-DsNYd1qp.js";import"./vendor-ui-Dpa_eFEd.js";import"./vendor-supabase-By2EX_dj.js";import"./useAuthenticatedUser-DxFjEeTf.js";const M=()=>{const r=u();j.useEffect(()=>{(async()=>{const{data:{session:a}}=await n.auth.getSession();a||r("/auth")})()},[r]);const{data:x,isLoading:m}=h({queryKey:["tenants"],queryFn:async()=>{const{data:s,error:a}=await n.from("profiles").select(`
          *,
          tenant_units!inner (
            id,
            unit:units (
              unit_number,
              property:properties (
                name
              )
            )
          )
        `).eq("role","tenant").eq("tenant_units.status","active");if(a)throw a;return s}}),o=(s,a)=>`${s?.[0]||""}${a?.[0]||""}`;return m?e.jsx(l,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-background",children:[e.jsx(c,{}),e.jsx("main",{className:"flex-1 p-8",children:e.jsx("div",{className:"text-center text-gray-400",children:"Loading tenants..."})})]})}):e.jsx(l,{children:e.jsxs("div",{className:"flex min-h-screen w-full bg-background",children:[e.jsx(c,{}),e.jsxs("main",{className:"flex-1 p-4 sm:p-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-white",children:"Tenants"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Manage your property tenants"})]}),e.jsx("div",{className:"rounded-lg border bg-card overflow-x-auto",children:e.jsxs(f,{className:"min-w-[600px]",children:[e.jsx(b,{children:e.jsxs(d,{children:[e.jsx(t,{children:"Tenant"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Current Unit"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(N,{children:x?.map(s=>e.jsxs(d,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(v,{children:e.jsx(g,{children:o(s.first_name,s.last_name)})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-white",children:[s.first_name,s.last_name].filter(Boolean).join(" ")})})]})}),e.jsx(i,{children:e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:s.email})]})})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.tenant_units?.[0]?.unit?.property?.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Unit ",s.tenant_units?.[0]?.unit?.unit_number]})]})}),e.jsx(i,{children:e.jsx(p,{variant:"outline",onClick:()=>r(`/tenants/${s.id}`),children:"View Profile"})})]},s.id))})]})})]})]})})};export{M as default};
